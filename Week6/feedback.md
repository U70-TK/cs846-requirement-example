# Week 6 Feedback: Code Generation

**Authors:** [Neel Sanjaybhai Faganiya, Ibrahim Mohammed Sayem, Felix Wang]

## 1. Counterexample Problems

**Github repository URL:** https://github.com/U70-TK/cs846-requirement-example

Find the related files in the `Week6` folder.

## Example Problems

### Problem A: 

**Github repository URL:** https://github.com/U70-TK/cs846-requirement-example


**Task Description:**

You are given a list of dictionaries representing sales transactions. Each transaction contains:
- `"product"`: a string product name
- `"quantity"`: a positive integer
- `"price"`: a positive float

Write a Python function `calculate_total_revenue(transactions)` that:
1. Validates that transactions is a non-empty list
2. Validates each transaction has the required keys and valid values
3. Returns the total revenue (sum of quantity × price for all transactions)
4. Raises a `ValueError` with a descriptive message if validation fails

**Example input:**
```python
transactions = [
    {"product": "Widget A", "quantity": 5, "price": 10.50},
    {"product": "Widget B", "quantity": 3, "price": 15.00},
    {"product": "Widget C", "quantity": 2, "price": 8.75}
]
```

**Expected output:** `115.0` (5×10.50 + 3×15.00 + 2×8.75 = 52.5 + 45 + 17.5)

**Starter Code:**

The code for this task and its related files can be found in the `artifacts` folder. The starter code is located at `artifacts/calc_rev.py`.


---

### Problem B: 

**Github repository URL:** https://github.com/U70-TK/cs846-requirement-example


**Task Description:**

**Starter Code:**

---

### Problem C: 

**Github repository URL:** https://github.com/U70-TK/cs846-requirement-example


**Task Description:**

**Student Tasks:**

---

### 2. Guidelines that didn't work

---

#### Guideline 3: Specify required external libraries/packages and their purpose.

**Prompt and Context:**

```
Solve the calculate_total_revenue problem in `artifacts/calc_rev.py`. You must use pandas for data manipulation 
and numpy for numerical operations. Use pandas DataFrame to validate and process the 
transactions. Run the test command: python3 -m unittest tests.test_revenue
```

**Task:**

Write a Python function `calculate_total_revenue(transactions)` that:
1. Validates that transactions is a non-empty list
2. Validates each transaction has the required keys and valid values
3. Returns the total revenue (sum of quantity × price for all transactions)
4. Raises a `ValueError` with a descriptive message if validation fails

**Solution or Output generated by Github Copilot:**

```python
import pandas as pd
import numpy as np

def calculate_total_revenue(transactions):
    """
    Calculate total revenue from a list of transaction dictionaries using pandas and numpy.
    
    Args:
        transactions: A list of dictionaries, each containing:
            - "product": a string product name (non-empty)
            - "quantity": a positive integer
            - "price": a positive float
    
    Returns:
        float: Total revenue (sum of quantity × price for all transactions)
    
    Raises:
        ValueError: If validation fails with a descriptive message
    """
    # Validate input
    if transactions is None:
        raise ValueError("transactions cannot be None")
    if not isinstance(transactions, list):
        raise ValueError("transactions must be a list")
    if len(transactions) == 0:
        raise ValueError("transactions cannot be empty")
    
    # Convert to DataFrame
    try:
        df = pd.DataFrame(transactions)
    except Exception as e:
        raise ValueError(f"Failed to create DataFrame from transactions: {e}")
    
    # Check required columns
    required_cols = {"product", "quantity", "price"}
    if not required_cols.issubset(df.columns):
        missing = required_cols - set(df.columns)
        raise ValueError(f"transactions missing required keys: {missing}")
    
    # Validate product: non-empty string
    if not df['product'].apply(lambda x: isinstance(x, str) and x.strip()).all():
        raise ValueError("All products must be non-empty strings")
    
    # Validate quantity: positive integer
    if not df['quantity'].apply(lambda x: isinstance(x, int) and x > 0).all():
        raise ValueError("All quantities must be positive integers")
    
    # Validate price: positive number
    if not df['price'].apply(lambda x: isinstance(x, (int, float)) and x > 0 and not np.isnan(x)).all():
        raise ValueError("All prices must be positive numbers")
    
    # Compute total revenue using numpy for numerical operations
    quantities = df['quantity'].values  # numpy array
    prices = df['price'].values  # numpy array
    revenues = np.multiply(quantities, prices)
    total = np.sum(revenues)
    
    return total

```

**Why this is bad:**
- **Over-engineered**: Uses pandas DataFrame for a simple list of dictionaries
- **Heavy dependencies**: Requires pandas and numpy for a trivial calculation
- **Performance overhead**: DataFrame creation and operations are slower than simple loops
- **Complexity**: More code, more potential failure points
- **Dependency issues**: May fail if pandas/numpy aren't installed or have version conflicts
- **Unnecessary abstraction**: The problem doesn't require tabular data operations

---

#### Guideline : 

**Prompt and Context:** 

**Task:**

**Solution or Output generated by Github Copilot:**


---

#### Guideline : 

**Prompt and Context:**  

**Task:** 

**Solution or Output generated by GitHub Copilot:**


...

---

### 3. New and Updated Guidelines that worked

#### Guideline 1:

**Prompt and Context:** 

**Task:** 

**Solution or Output generated by Github Copilot:**


---

#### Guideline 2: 

**Prompt and Context:**

**Task:**

**Solution or Output generated by Github Copilot:**

---

#### Guideline 3: 

**Prompt and Context:**

**Task:** 

**Solution or Output generated by GitHub Copilot:**

...

---
